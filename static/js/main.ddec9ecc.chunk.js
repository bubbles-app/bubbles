(this.webpackJsonpbubbles=this.webpackJsonpbubbles||[]).push([[0],{41:function(e,t,n){},42:function(e,t,n){},56:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),s=n(26),c=n.n(s),i=(n(41),n(14)),r=n(3),l=(n(42),n(0));var u=function(){return Object(l.jsxs)("div",{className:"Bubbles",children:[Object(l.jsx)("div",{className:"bubble"}),Object(l.jsx)("div",{className:"bubble"}),Object(l.jsx)("div",{className:"bubble"}),Object(l.jsx)("div",{className:"bubble"}),Object(l.jsx)("div",{className:"bubble"}),Object(l.jsx)("div",{className:"bubble"}),Object(l.jsx)("div",{className:"bubble"}),Object(l.jsx)("div",{className:"bubble"}),Object(l.jsx)("div",{className:"bubble"}),Object(l.jsx)("div",{className:"bubble"})]})},d=n(4),b=n(13),m=n.n(b),j=n(17),p=n(10),h=n.n(p),O=(n(56),n(18)),f=n(19),v=n(11),g=n(22),y=n(20),x={userName:"solace-cloud-client",password:"m3mpet3g503rr1df5ole2rcgff",invocationContext:{host:"mr1n34cqfh5s9n.messaging.solace.cloud",port:8443,clientId:""},timeout:3,keepAliveInterval:60,cleanSession:!0,useSSL:!0,reconnect:!0},N=n(9),S=n.n(N),k=new(function(e){Object(g.a)(n,e);var t=Object(y.a)(n);function n(){var e;return Object(O.a)(this,n),(e=t.call(this,x.invocationContext.host,Number(x.invocationContext.port),x.invocationContext.clientId)).onMessageArrived=e.handleMessage.bind(Object(v.a)(e)),e.callbacks=[],e}return Object(f.a)(n,[{key:"connectWithPromise",value:function(){var e=this;return new Promise((function(t,n){x.onSuccess=t,x.onFailure=n,e.connect(x)}))}},{key:"onConnectionLost",value:function(e){0!==e.errorCode&&console.log("Connection lost with Solace Cloud")}},{key:"register",value:function(e){this.callbacks.push(e)}},{key:"handleMessage",value:function(e){console.log("Received message",e.payloadString),this.callbacks.forEach((function(t){return t(e)}))}}]),n}(S.a.Client));h.a.setAppElement("#modal-portal");var C={overlay:{backgroundColor:"none"},content:{width:"15%",minWidth:"200px",borderRadius:"10px",top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",zIndex:"1000",color:"rgba(0, 0, 0, 0.5)"}};var V=function(e){var t=e.isOpen,n=e.closeModal,o=e.contentLabel,s=Object(a.useState)(""),c=Object(d.a)(s,2),i=c[0],u=c[1],b=Object(a.useState)(""),p=Object(d.a)(b,2),O=p[0],f=p[1],v=Object(a.useState)(!1),g=Object(d.a)(v,2),y=g[0],x=g[1],N=Object(a.useState)(!1),S=Object(d.a)(N,2),V=S[0],P=S[1];if(V)return console.log("redirecting to",O),Object(l.jsx)(r.a,{to:{pathname:"/room",state:{roomcode:O,nickname:i}}});var w=function(){var e=Object(j.a)(m.a.mark((function e(t){var n,a,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""===i){e.next=20;break}return e.prev=2,e.next=5,fetch("".concat("https://bubbles-app-backend.herokuapp.com","/createroom"),{method:"POST"}).then((function(e){return e.json()}));case 5:return n=e.sent,a=n.message,o={roomcode:a,username:i},f(a),e.next=11,fetch("".concat("https://bubbles-app-backend.herokuapp.com","/joinroom"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 11:200===e.sent.status?k.connectWithPromise().then((function(e){console.log("Succesfully connected to Solace Cloud.",e),k.subscribe(a),console.log(k),P(!0)})).catch((function(e){console.log("Unable to establish connection with Solace Cloud, see above logs for more details.",e),R()})):(x(!0),R()),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(2),console.log(e.t0),x(!0),R();case 20:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){u("")};return Object(l.jsxs)(h.a,{isOpen:t,onRequestClose:n,style:C,contentLabel:o,children:[Object(l.jsx)("p",{className:"modal-header",children:"nickname"}),Object(l.jsxs)("form",{className:"modal-form",onSubmit:w,children:[Object(l.jsx)("input",{className:"modal-name-input",type:"text",value:i,onChange:function(e){return u(e.target.value)},maxLength:15}),Object(l.jsx)("button",{className:"modal-submit-button",disabled:""===i,children:"join"})]}),Object(l.jsx)("p",{style:{marginBottom:0,color:"#f44",display:y?"block":"none"},children:"Our servers are having some issues at the moment..."})]})};n(62);h.a.setAppElement("#modal-portal");var P={overlay:{backgroundColor:"none"},content:{width:"15%",minWidth:"200px",borderRadius:"10px",padding:"30px",top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",zIndex:"1000",color:"rgba(0, 0, 0, 0.5)"}};var w=function(e){var t=e.isOpen,n=e.closeModal,o=e.contentLabel,s=Object(a.useState)(""),c=Object(d.a)(s,2),i=c[0],u=c[1],b=Object(a.useState)(""),p=Object(d.a)(b,2),O=p[0],f=p[1],v=Object(a.useState)(!1),g=Object(d.a)(v,2),y=g[0],x=g[1],N=Object(a.useState)(!1),S=Object(d.a)(N,2),C=S[0],V=S[1];if(C)return console.log("redirecting to",i),Object(l.jsx)(r.a,{to:{pathname:"/room",state:{roomcode:i,nickname:O}}});var w=function(){var e=Object(j.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,n={roomcode:i,username:O},e.next=5,fetch("".concat("https://bubbles-app-backend.herokuapp.com","/joinroom"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 5:200===e.sent.status?k.connectWithPromise().then((function(e){console.log("Succesfully connected to Solace Cloud.",e),k.subscribe(i),V(!0)})).catch((function(e){console.log("Unable to establish connection with Solace Cloud, see above logs for more details.",e),R()})):(x(!0),R()),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),x(!0),R();case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){u(""),f("")};return Object(l.jsxs)(h.a,{isOpen:t,onRequestClose:n,style:P,contentLabel:o,children:[Object(l.jsxs)("form",{className:"modal-join-form",onSubmit:w,children:[Object(l.jsx)("p",{className:"modal-join-header",children:"bubble code"}),Object(l.jsx)("input",{className:"modal-join-code-input",type:"text",value:i,onChange:function(e){return u(e.target.value)}}),Object(l.jsx)("p",{className:"modal-join-header",children:"nickname"}),Object(l.jsx)("input",{className:"modal-join-name-input",type:"text",value:O,onChange:function(e){return f(e.target.value)},maxLength:15}),Object(l.jsx)("button",{className:"modal-join-submit-button",children:"join"})]}),Object(l.jsx)("p",{style:{marginBottom:0,color:"#f44",display:y?"block":"none"},children:"Please enter a valid room code."})]})},R=n.p+"static/media/logo.cead2453.svg";n(63);var M=function(){var e=Object(a.useState)(!1),t=Object(d.a)(e,2),n=t[0],o=t[1],s=Object(a.useState)(!1),c=Object(d.a)(s,2),i=c[0],r=c[1];return Object(a.useEffect)((function(){try{k.disconnect()}catch(e){console.log(e)}}),[]),Object(l.jsxs)("div",{className:"MainMenu",children:[Object(l.jsxs)("div",{style:{display:n||i?"none":"block"},children:[Object(l.jsxs)("div",{className:"logo-section",children:[Object(l.jsx)("h1",{className:"logo-text",children:"bubbles"}),Object(l.jsx)("img",{className:"logo-pic",src:R,alt:"logo"})]}),Object(l.jsxs)("div",{className:"menu-buttons",children:[Object(l.jsx)("p",{className:"menu-button",onClick:function(){return r(!0)},children:"start a bubble"}),Object(l.jsx)("p",{className:"menu-button",onClick:function(){return o(!0)},children:"join a bubble"})]})]}),Object(l.jsx)(V,{isOpen:i,closeModal:function(){return r(!1)},contentLabel:"Create A Bubble"}),Object(l.jsx)(w,{isOpen:n,closeModal:function(){return o(!1)},contentLabel:"Join A Bubble"})]})},L=n(34),B=function(e){Object(g.a)(n,e);var t=Object(y.a)(n);function n(e){var a;return Object(O.a)(this,n),(a=t.call(this,e)).playNewVideo=a.playNewVideo.bind(Object(v.a)(a)),a.playVideo=a.playVideo.bind(Object(v.a)(a)),a.pauseVideo=a.pauseVideo.bind(Object(v.a)(a)),a.onPlayerReady=a.onPlayerReady.bind(Object(v.a)(a)),a.videoId="",a.state={player:null,videoOptions:{height:"100%",width:"100%"}},a}return Object(f.a)(n,[{key:"handleMessage",value:function(e){var t=JSON.parse(e.payloadString);console.log("Handle message here!"),"playPressed"===t.messageType&&this.playVideo(),"pausePressed"===t.messageType&&this.pauseVideo()}},{key:"playNewVideo",value:function(e){this.videoId=e,this.state.player.loadVideoById(this.videoId,0)}},{key:"playVideo",value:function(){console.log(this.state),this.state.player.playVideo()}},{key:"pauseVideo",value:function(){this.state.player.pauseVideo()}},{key:"onPlayerReady",value:function(e){console.log("Player is ready: ",e),this.state.player=e.target,k.register(this.handleMessage.bind(this))}},{key:"onVideoPlay",value:function(e){console.log("Video played at: ",e.target.getCurrentTime());var t=new S.a.Message(JSON.stringify({messageType:"playPressed",message:"Play press detected"}));t.destinationName=this.props.roomcode,k.send(t)}},{key:"onVideoPause",value:function(e){console.log("Video paused at: ",e);var t=new S.a.Message(JSON.stringify({messageType:"pausePressed",message:"Pause press detected"}));t.destinationName=this.props.roomcode,k.send(t)}},{key:"onVideoPlaybackRateChange",value:function(e){console.log("Video playback rate changed: ",e)}},{key:"onVideoStateChange",value:function(e){console.log("Video state changed: ",e),console.log("state: ",this.state)}},{key:"onVideoEnd",value:function(){console.log("Video ended")}},{key:"onVideoError",value:function(e){console.log("Video error: ",e)}},{key:"render",value:function(){return Object(l.jsx)(L.a,{videoId:this.videoId,className:"Video",opts:this.state.videoOptions,onReady:this.onPlayerReady.bind(this),onPlay:this.onVideoPlay.bind(this),onPause:this.onVideoPause.bind(this),onPlaybackRateChange:this.onVideoPlaybackRateChange.bind(this),onStateChange:this.onVideoStateChange.bind(this),onEnd:this.onVideoEnd.bind(this)})}}]),n}(a.Component),T=n(21);n(76);h.a.setAppElement("#modal-portal");var I={overlay:{backgroundColor:"none"},content:{borderRadius:"10px",top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",zIndex:"1000",color:"rgba(0, 0, 0, 0.5)"}};var E=function(e){var t=e.isOpen,n=e.closeModal,o=e.contentLabel,s=e.queueVideo,c=e.roomcode;Object(a.useEffect)((function(){k.register(i)}),[]);var i=function(e){console.log("NEW MSG");try{var t=JSON.parse(e.payloadString);if("newVideoURL"===t.messageType){var n=new URL(t.url);s(n.searchParams.get("v"))}}catch(a){console.log(a)}};return Object(l.jsxs)(h.a,{isOpen:t,onRequestClose:n,style:I,contentLabel:o,children:[Object(l.jsx)("p",{className:"modal-play-header",children:"youtube video url"}),Object(l.jsxs)("form",{className:"modal-play-form",onSubmit:function(e){e.preventDefault();try{var t=new URL(document.getElementById("youtube-link-input").value);s(t.searchParams.get("v"));var a=new S.a.Message(JSON.stringify({messageType:"newVideoURL",url:t}));a.destinationName=c,k.send(a)}catch(o){console.log(o)}n()},children:[Object(l.jsx)("input",{id:"youtube-link-input",className:"modal-play-input",type:"text"}),Object(l.jsx)("button",{className:"modal-play-submit-button",children:"play"})]})]})};var J=function(e){var t=e.label,n=e.className,a=e.onClick;return Object(l.jsx)("p",{className:n,onClick:a,children:t})};n(77);var q=function(e){var t=e.list,n=Object(a.useState)(!0),o=Object(d.a)(n,2),s=o[0],c=o[1];return Object(l.jsxs)("div",{className:"SideBarList",children:[Object(l.jsx)(J,{className:"SideBarList-Toggle",label:"members",onClick:function(){return c(!s)}}),Object(l.jsx)("div",{style:{display:s?"block":"none"},className:"SideBarList-Items",children:t.map((function(e,t){return Object(l.jsx)("p",{children:e},t)}))})]})};n(78);var A=function(e){var t=e.roomcode,n=e.username,o=Object(a.useState)(""),s=Object(d.a)(o,2),c=s[0],i=s[1],r=Object(a.useState)([]),u=Object(d.a)(r,2),b=u[0],m=u[1],j=Object(a.useRef)();Object(a.useEffect)((function(){k.register(p)}),[]);var p=function(e){try{var t=JSON.parse(e.payloadString);if("newTextMessage"===t.messageType){var n={username:t.username,text:t.text};m((function(e){return[].concat(Object(T.a)(e),[n])}))}}catch(a){console.log(a)}h()},h=function(){j.current.scrollIntoView({behavior:"smooth"})};return Object(l.jsxs)("div",{className:"SideBarChat",children:[Object(l.jsxs)("div",{className:"SideBarChat-Items",children:[b.map((function(e,t){var n=e.username,a=e.text;return Object(l.jsxs)("p",{className:"SideBarChat-Item",children:[n,": ",a]},t)})),Object(l.jsx)("div",{ref:j,className:"SideBarChat-anchor"})]}),Object(l.jsx)("form",{className:"SideBarChat-Form",onSubmit:function(e){if(e.preventDefault(),""!==c){var a=new S.a.Message(JSON.stringify({messageType:"newTextMessage",username:n,text:c}));a.destinationName=t,k.send(a),i("")}},children:Object(l.jsx)("input",{type:"text",value:c,onChange:function(e){return i(e.target.value)}})})]})};n(79);var U=function(e){var t=e.roomcode,n=e.username,o=e.queueVideo,s=Object(a.useState)(!1),c=Object(d.a)(s,2),i=c[0],r=c[1],u=Object(a.useState)([]),b=Object(d.a)(u,2),m=b[0],j=b[1];Object(a.useEffect)((function(){k.register(p),fetch("".concat("https://bubbles-app-backend.herokuapp.com","/getUsers"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomcode:t})}).then((function(e){return e.json()})).then((function(e){return j(e.users)})).catch((function(e){return console.log(e)}))}),[]);var p=function(e){console.log("old members",m);try{var t=JSON.parse(e.payloadString);"userJoined"===t.messageType&&j((function(e){return console.log("OLD MEMBERS",e),[].concat(Object(T.a)(e),[t.username])}))}catch(n){console.log(n)}};return Object(l.jsxs)("div",{className:"SideBar",children:[Object(l.jsxs)("div",{className:"SideBar-Top",children:[Object(l.jsx)(J,{label:t,className:"RoomCodeLabel"}),Object(l.jsx)(q,{list:m,roomcode:t}),Object(l.jsx)(A,{roomcode:t,username:n})]}),Object(l.jsxs)("div",{className:"SideBar-Buttons",children:[Object(l.jsx)("button",{className:"play-button",onClick:function(){return r(!0)},children:"play"}),Object(l.jsx)("button",{className:"exit-button",children:"exit"})]}),Object(l.jsx)(E,{isOpen:i,closeModal:function(){return r(!1)},contentLabel:"Play Video",queueVideo:o,roomcode:t})]})};n(80);var W=function(e){if(!e.location.state)return Object(l.jsx)(r.a,{to:"/"});var t=e.location.state,n=t.roomcode,a=t.nickname,o=new B({roomcode:n});return Object(l.jsxs)("div",{className:"RoomScreen",children:[Object(l.jsx)(U,{roomcode:n,queueVideo:o.playNewVideo,username:a}),Object(l.jsx)("div",{className:"VideoSection",children:o.render()})]})};n(81);var D=function(){return Object(l.jsxs)("div",{className:"App",children:[Object(l.jsx)(u,{}),Object(l.jsx)(i.a,{basename:"/",children:Object(l.jsxs)(r.d,{children:[Object(l.jsx)(r.b,{path:"/",exact:!0,component:M}),Object(l.jsx)(r.b,{path:"/room",exact:!0,component:W})]})})]})};c.a.render(Object(l.jsx)(o.a.StrictMode,{children:Object(l.jsx)(D,{})}),document.getElementById("root"))}},[[82,1,2]]]);
//# sourceMappingURL=main.ddec9ecc.chunk.js.map